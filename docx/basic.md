# 音视频基础知识

（来源[罗上文老师博客](https://ffmpeg.xianwaizhiyin.net/base-knowledge/raw-rgb.html)）

## RGB

    RGB色彩空间,分别表示Red,Green,Blue。

1. 像素格式：以**RGB24**为例子：其中R占8位，G占8位，B占8位，因此一个像素占24位，这种格式混合有 `256 * 256 * 256 = 16777216` 种颜色，故占用空间大。
2. 索引格式，RGB 的值是一个索引，不是真正的颜色值，例如 RGB 的值 占 1位，那只有两个值 0 跟 1，通常用于黑白颜色，这种情况下 一个像素只占 1位，大大节省了空间。0 跟 1 到底是什么颜色，是通过 索引表（也叫调色板）来定位的，不一定是 黑白，也可以是其他的颜色。所以叫索引格式。
   只占 1 位的 RGB 成为  **RGB1** ，还有 **RGB4** 占 4 位，索引表有 16 种颜色， **RGB8** 占 8 位，索引表有 256 种颜色。（不懂x……x）

   扩展知识：不需要 索引表/调色板 的 RGB 模式 称为  **真彩色** 。

### BMP文件格式概述

1. 什么是BMP
   BMP是常见的RGB文件格式，全称为Bitmap-File,是微软家出品的。是无损的。
2. BMP文件格式
   **文件头：**（14bytes）,存放文件相关信息；
   **信息头：**（40bytes），也可理解为**图像信息头** ，存放一些图像相关信息，如宽高之类的；
   **调试板：** 大小由颜色索引决定，将颜色表项的数量乘以每个颜色表项大小（4字节），如果一个BMP图像使用8位颜色深度，那么它将有256种颜色，颜色表的大小将是：颜色表大小=256×4字节=1024字节，RGB24为真彩色，没有用到调色板，所以这个区域是0字节。
   **位图数据:**   RGB数据，一个像素占3个字节

* BMP文件头

  BMP信息头 是从 第 15 个字节开始的，前面 14 个字节 被 BMP文件头 用了。第 15 ~ 18 字节是 BMP信息头 的大小。第 19 ~ 22 字节 是 图像的 **宽度** ，单位是像素。第 23 ~ 26 字节 是 图像的 **高度** ，单位是像素，第 27 ~ 28 字节是 color planes 的数量 ，通常是 01，第 29 ~ 30 字节是 指每个像素 需要多少 位来存储，第 31~ 34 字节是 压缩类型，没有压缩，是 0。第 35~ 38 字节是 图像大小，不包含 BMP文件头 跟 BMP信息头，其实 BMP文件头就有 总文件大小，第 39~ 42 字节是 **Width** resolution in pixels per meter，水平分辨率，第 43~ 45 字节是 **Height** resolution in pixels per meter，垂直分辨率，第 46~ 49 字节是 颜色表中的颜色索引数，本文没有索引表，是真彩色，第 50~ 53字节表示对图像显示有重要影响的颜色索引数码， 00 ：代表全都重要。

### FFmpeg处理bmp文件

FFmpeg 可以自由 转换 jpeg 跟 bmp，命令如下：

```
ffmpeg -i juren.jpg juren.bmp
```

```
ffmpeg -i juren.bmp juren.jpg
```



## YUV

    YUV色彩空间适合用于编码和存储，因此在在存储和编码之前，RGB 图像要转换为 YUV 图像，而 YUV 图像在 显示之前通常有必要转换回 RGB。

    为什么 YUV 色彩空间 在音视频开发，编码压缩领域更加常用，这个涉及到 HVS （Human Visual System）人类视觉系统 对 色彩空间的感知能力。视觉心理学研究表明，人的视觉系统对光的感知程度可以用两个属性来描述：**亮度（luminance）** 跟  **色度（chrominance）** ，这里的色度也叫做 饱和度或彩度。

**
    色度感知** 包含两个维度： **色调** （Hue）和  **色饱和度** （saturation）。色调是由光波的峰值定义的，描述的是光的颜色。色饱和度是由光波的谱宽定义的，描述的是光的纯度。

因此 HVS 对色彩的感知主要有 3个属性：亮度（luminance），色调（Hue）和 色饱和度（saturation）。也就是 YUV 色彩空间，Y 代表 亮度，U代表色调，V代表色饱和度。  

    经过大量研究实验表明，**视觉系统 对 色度 的敏感度 是远小于 亮度的** 。所以可以对 色度 采用更小的采样率来压缩数据，对亮度采用正常的采样率即可，这样压缩数据不会对视觉体验产生太大的影响。简单来说就是用更少的数据/信息来表达 色度（chroma），用更多的数据/信息来表达 亮度（luminance）。

1. YUV分类

   YIQ 适用于NTSC彩色电视制式

    YUV 适用于PAL和SECAM彩色电视制式

    YCbCr适用于计算机用的显示器


YUV 里面的 U 就是 Cb ，术语是  **色调** （Hue）。V 就是 Cr ，术语是  **色饱和度** （saturation）。

实际上你可以把 UV 看成是 ，colour difference （色彩的差异），请看下图三条公式：

```
Cb=Blue−Y
```

```
Cr=Red−Y
```

```
Cg=Green−Y
```

Cb 代表 蓝色 色度的分量，是通过 RGB 里面的 B 的值 减去 Y 的值得到的。

Cr 代表 红色 色度的分量，是通过 RGB 里面的 R 的值 减去 Y 的值得到的。

Cg 代表 绿色色 色度的分量，是通过 RGB 里面的 G 的值 减去 Y 的值得到的。
